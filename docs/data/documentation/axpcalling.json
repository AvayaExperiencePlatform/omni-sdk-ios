{"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/axpcalling"]}],"metadata":{"symbolKind":"module","modules":[{"name":"AXPCalling"}],"title":"AXPCalling","role":"collection","externalID":"AXPCalling","roleHeading":"Framework"},"schemaVersion":{"major":0,"minor":3,"patch":0},"sections":[],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/com.avaya.axp.client.sdk.AXPCalling\/documentation\/AXPCalling"},"kind":"symbol","topicSections":[{"title":"Classes","identifiers":["doc:\/\/com.avaya.axp.client.sdk.AXPCalling\/documentation\/AXPCalling\/AXPCallingSDK","doc:\/\/com.avaya.axp.client.sdk.AXPCalling\/documentation\/AXPCalling\/Call"]},{"identifiers":["doc:\/\/com.avaya.axp.client.sdk.AXPCalling\/documentation\/AXPCalling\/CallDelegate"],"title":"Protocols"},{"title":"Structures","identifiers":["doc:\/\/com.avaya.axp.client.sdk.AXPCalling\/documentation\/AXPCalling\/CallOptions"]}],"primaryContentSections":[{"content":[{"anchor":"Overview","level":2,"text":"Overview","type":"heading"},{"inlineContent":[{"text":"Use the calling module to make calls from your app to your contact center using the device’s internet connection. Making calls this way allows contextual information to be attached to the call, enables use of high-quality audio, and avoids PSTN charges.","type":"text"}],"type":"paragraph"},{"type":"heading","level":3,"text":"Creating an Integration ID","anchor":"Creating-an-Integration-ID"},{"inlineContent":[{"type":"text","text":"To connect to the Avaya Experience Platform your app will need an Omni SDK integration administered on the system. A list of high level steps that are required to administer the integration are mentioned "},{"identifier":"https:\/\/developers.avayacloud.com\/avaya-experience-platform\/docs\/omni-sdk-introduction#next-steps","type":"reference","isActive":true},{"type":"text","text":"."}],"type":"paragraph"},{"text":"Configuring Your App for Calling","anchor":"Configuring-Your-App-for-Calling","type":"heading","level":3},{"type":"paragraph","inlineContent":[{"type":"text","text":"To support making an audio call in your app a few project settings will need to be configured. Your app will need to request permission to use the device’s microphone and must provide a reason for this permission request. In Xcode, select your application target, then Build Settings and enter a value for “Privacy - Microphone Usage Description”."}]},{"inlineContent":[{"type":"text","text":"To allow audio and call controls to work while your application is in the background the appropriate background modes will also need to be configured. While still in target settings in Xcode select Signing & Capabilities, then under Background Modes enable “Audio, AirPlay, and Picture in Picture” and “Voice over IP”."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"background-modes"}]},{"level":3,"anchor":"Initializing-the-SDK","type":"heading","text":"Initializing the SDK"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Before using the SDK for the first time it must be initialized by calling "},{"type":"codeVoice","code":"AXPClientSDK.configureSDK()"},{"type":"text","text":" supplying your integration ID, token provider, and the region-specific AXP system you wish to connect to:"}]},{"type":"codeListing","syntax":"swift","code":["AXPClientSDK.configureSDK(","  applicationKey: applicationKey,","  integrationID: integrationID,","  tokenProvider: tokenProvider,","  host: axpRegionURL,","  displayName: \"Calling Sample App User\",",")"]},{"level":3,"text":"Configuring CallKit Integration","type":"heading","anchor":"Configuring-CallKit-Integration"},{"inlineContent":[{"identifier":"https:\/\/developer.apple.com\/documentation\/callkit\/","isActive":true,"type":"reference"},{"text":" is an iOS system framework that manages calls across all sources on the system and integrates your app’s calls with iOS features like call controls on the lock screen, Bluetooth headsets, and CarPlay.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"image","identifier":"callkit-screen"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"If the AXP calling module is the only use of calling in your app the module can manage integration with CallKit for you automatically. To opt-in to this automatic integration call "},{"type":"codeVoice","code":"AXPCalling\/configureCallKit(iconTemplateImageData:includesCallsInRecents:)"},{"text":":","type":"text"}]},{"code":["AXPCallingSDK.configureCallKit(","  iconTemplateImageData: UIImage(resource: .callKitIcon).pngData()",")"],"type":"codeListing","syntax":"swift"},{"type":"paragraph","inlineContent":[{"text":"The icon template is an optional icon representing your application that will appear on the CallKit screen. It should be a square image with a size of 40 x 40 points.","type":"text"}]},{"anchor":"Authenticating-with-AXP","text":"Authenticating with AXP","level":3,"type":"heading"},{"inlineContent":[{"type":"text","text":"Authenticating with AXP is accomplished through the token provider configured in the call to "},{"type":"codeVoice","code":"AXPClientSDK.configureSDK()"},{"type":"text","text":". When the SDK requires a new authentication token it will call the token provider’s "},{"code":"fetchToken()","type":"codeVoice"},{"text":" method. This method will only be called when a new token is required, the SDK will manage caching of the token your app returns to it. In response to the SDK calling ","type":"text"},{"type":"codeVoice","code":"fetchToken()"},{"text":" your app should communicate with its backend server to obtain a new access token from AXP. AXP tokens are relatively short-lived so a new token may need to be fetched multiple times during a call.","type":"text"}],"type":"paragraph"},{"anchor":"Requesting-Device-Permissions","type":"heading","text":"Requesting Device Permissions","level":3},{"type":"paragraph","inlineContent":[{"text":"Before starting a call your app should request permission to make use of the device’s microphone. The system will do this automatically the first time your app attempts to use the mic, but it is better to request permission before starting a call so that the call does not connect to your contact center with the user unable to transmit their audio.","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["if await AVCaptureDevice.requestAccess(for: .audio) {","  startCall()","} else {","  \/\/ Show a message to the user explaining why the call cannot be started","  \/\/ and that permissions can be updated in the Settings app.","}"]},{"text":"Making a Call","level":3,"type":"heading","anchor":"Making-a-Call"},{"inlineContent":[{"type":"text","text":"To make a call to your contact center, call "},{"type":"codeVoice","code":"AXPCalling\/createCall(options:delegate:delegateQueue:)"},{"type":"text","text":" passing the options to use when creating the call and a delegate that will react to events received both while the call is connecting and while it is active."}],"type":"paragraph"},{"syntax":"swift","code":["let callOptions = CallOptions(","  remoteDisplayName: \"Customer Support\",","  remoteAddress: \"+18005551234\",",")","","let call = AXPCallingSDK.createCall(options: callOptions, delegate: self)","","\/\/ Connect the call to your user interface and perform any additional","\/\/ configuration.","","call.start()"],"type":"codeListing"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The remote display name is used for CallKit integration to display the name of the remote side of the call - your contact center. The remote address must be a phone number associated with a voice channel for your AXP account."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The call will not start immediately after calling "},{"type":"codeVoice","code":"createCall()"},{"type":"text","text":", providing your app with an opportunity to set up its user interface and perform any other configuration you wish to make on the call like setting the initial mute state. When you’re ready to connect the call invoke its "},{"isActive":true,"type":"reference","identifier":"doc:\/\/com.avaya.axp.client.sdk.AXPCalling\/documentation\/AXPCalling\/Call\/start()"},{"type":"text","text":" method."}]},{"type":"heading","anchor":"Responding-to-Events","level":3,"text":"Responding to Events"},{"type":"paragraph","inlineContent":[{"type":"text","text":"An audio call is an asynchronous operation and the call’s lifecycle events will be communicated though the "},{"type":"reference","identifier":"doc:\/\/com.avaya.axp.client.sdk.AXPCalling\/documentation\/AXPCalling\/CallDelegate","isActive":true},{"type":"text","text":" methods. Your application should be prepared to handle the call ending or failing at any time."}]},{"inlineContent":[{"type":"text","text":"Your app does not need to take any action in response to network outages, roaming between nextworks, or the user switching audio devices. The calling module will handle these cases automatically."}],"type":"paragraph"},{"level":3,"text":"Ending a Call","type":"heading","anchor":"Ending-a-Call"},{"inlineContent":[{"type":"text","text":"All paths that end a call will invoke the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/com.avaya.axp.client.sdk.AXPCalling\/documentation\/AXPCalling\/CallDelegate"},{"type":"text","text":" method "},{"identifier":"doc:\/\/com.avaya.axp.client.sdk.AXPCalling\/documentation\/AXPCalling\/CallDelegate\/callDidEnd(_:)","type":"reference","isActive":true},{"type":"text","text":". Once this has been called the call operation is completed. To initiate ending a call locally invoke the "},{"isActive":true,"type":"reference","identifier":"doc:\/\/com.avaya.axp.client.sdk.AXPCalling\/documentation\/AXPCalling\/Call"},{"text":" object’s ","type":"text"},{"identifier":"doc:\/\/com.avaya.axp.client.sdk.AXPCalling\/documentation\/AXPCalling\/Call\/end()","isActive":true,"type":"reference"},{"type":"text","text":" method."}],"type":"paragraph"}],"kind":"content"}],"hierarchy":{"paths":[[]]},"abstract":[{"type":"text","text":"Make audio calls using the Avaya Experience Platform."}],"references":{"doc://com.avaya.axp.client.sdk.AXPCalling/documentation/AXPCalling/Call/start()":{"kind":"symbol","role":"symbol","url":"\/documentation\/axpcalling\/call\/start()","fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"text":"start","kind":"identifier"},{"kind":"text","text":"()"}],"abstract":[{"type":"text","text":"Starts the call."}],"title":"start()","type":"topic","identifier":"doc:\/\/com.avaya.axp.client.sdk.AXPCalling\/documentation\/AXPCalling\/Call\/start()"},"doc://com.avaya.axp.client.sdk.AXPCalling/documentation/AXPCalling/AXPCallingSDK":{"kind":"symbol","type":"topic","role":"symbol","url":"\/documentation\/axpcalling\/axpcallingsdk","abstract":[{"type":"text","text":"Interface into the calling module."}],"fragments":[{"text":"class","kind":"keyword"},{"kind":"text","text":" "},{"text":"AXPCallingSDK","kind":"identifier"}],"navigatorTitle":[{"kind":"identifier","text":"AXPCallingSDK"}],"title":"AXPCallingSDK","identifier":"doc:\/\/com.avaya.axp.client.sdk.AXPCalling\/documentation\/AXPCalling\/AXPCallingSDK"},"https://developer.apple.com/documentation/callkit/":{"titleInlineContent":[{"type":"codeVoice","code":"CallKit"}],"identifier":"https:\/\/developer.apple.com\/documentation\/callkit\/","title":"CallKit","type":"link","url":"https:\/\/developer.apple.com\/documentation\/callkit\/"},"callkit-screen":{"variants":[{"traits":["3x","light"],"url":"\/images\/callkit-screen@3x.png"}],"type":"image","identifier":"callkit-screen","alt":"An active call on the system CallKit screen"},"doc://com.avaya.axp.client.sdk.AXPCalling/documentation/AXPCalling/Call":{"role":"symbol","title":"Call","type":"topic","kind":"symbol","url":"\/documentation\/axpcalling\/call","abstract":[{"type":"text","text":"A realtime audio call between the local device and your call center."}],"fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"Call"}],"navigatorTitle":[{"text":"Call","kind":"identifier"}],"identifier":"doc:\/\/com.avaya.axp.client.sdk.AXPCalling\/documentation\/AXPCalling\/Call"},"https://developers.avayacloud.com/avaya-experience-platform/docs/omni-sdk-introduction#next-steps":{"titleInlineContent":[{"text":"here","type":"text"}],"identifier":"https:\/\/developers.avayacloud.com\/avaya-experience-platform\/docs\/omni-sdk-introduction#next-steps","url":"https:\/\/developers.avayacloud.com\/avaya-experience-platform\/docs\/omni-sdk-introduction#next-steps","type":"link","title":"here"},"doc://com.avaya.axp.client.sdk.AXPCalling/documentation/AXPCalling/CallDelegate/callDidEnd(_:)":{"identifier":"doc:\/\/com.avaya.axp.client.sdk.AXPCalling\/documentation\/AXPCalling\/CallDelegate\/callDidEnd(_:)","required":true,"abstract":[{"text":"Tells the delegate that the call has ended.","type":"text"}],"url":"\/documentation\/axpcalling\/calldelegate\/calldidend(_:)","type":"topic","role":"symbol","kind":"symbol","title":"callDidEnd(_:)","fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"kind":"identifier","text":"callDidEnd"},{"text":"(","kind":"text"},{"text":"Call","kind":"typeIdentifier","preciseIdentifier":"s:10AXPCalling4CallC"},{"text":")","kind":"text"}]},"doc://com.avaya.axp.client.sdk.AXPCalling/documentation/AXPCalling/CallOptions":{"navigatorTitle":[{"text":"CallOptions","kind":"identifier"}],"title":"CallOptions","url":"\/documentation\/axpcalling\/calloptions","identifier":"doc:\/\/com.avaya.axp.client.sdk.AXPCalling\/documentation\/AXPCalling\/CallOptions","role":"symbol","abstract":[{"text":"Options to use when creating a call.","type":"text"}],"kind":"symbol","type":"topic","fragments":[{"kind":"keyword","text":"struct"},{"text":" ","kind":"text"},{"text":"CallOptions","kind":"identifier"}]},"background-modes":{"identifier":"background-modes","alt":"Application target background mode settings","type":"image","variants":[{"url":"\/images\/background-modes@2x.png","traits":["2x","light"]}]},"doc://com.avaya.axp.client.sdk.AXPCalling/documentation/AXPCalling":{"abstract":[{"type":"text","text":"Make audio calls using the Avaya Experience Platform."}],"title":"AXPCalling","role":"collection","identifier":"doc:\/\/com.avaya.axp.client.sdk.AXPCalling\/documentation\/AXPCalling","kind":"symbol","type":"topic","url":"\/documentation\/axpcalling"},"doc://com.avaya.axp.client.sdk.AXPCalling/documentation/AXPCalling/Call/end()":{"abstract":[{"text":"Ends the call.","type":"text"}],"title":"end()","identifier":"doc:\/\/com.avaya.axp.client.sdk.AXPCalling\/documentation\/AXPCalling\/Call\/end()","url":"\/documentation\/axpcalling\/call\/end()","kind":"symbol","type":"topic","role":"symbol","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"text":"end","kind":"identifier"},{"text":"()","kind":"text"}]},"doc://com.avaya.axp.client.sdk.AXPCalling/documentation/AXPCalling/CallDelegate":{"title":"CallDelegate","identifier":"doc:\/\/com.avaya.axp.client.sdk.AXPCalling\/documentation\/AXPCalling\/CallDelegate","type":"topic","role":"symbol","abstract":[{"text":"An interface that communicates changes to a call’s state.","type":"text"}],"kind":"symbol","fragments":[{"text":"protocol","kind":"keyword"},{"kind":"text","text":" "},{"kind":"identifier","text":"CallDelegate"}],"navigatorTitle":[{"kind":"identifier","text":"CallDelegate"}],"url":"\/documentation\/axpcalling\/calldelegate"}}}